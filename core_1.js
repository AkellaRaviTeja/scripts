!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Apxor=t()}(this,function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach(function(e){s(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,s,a=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=o.call(n)).done)&&(a.push(i.value),a.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var f={enable:!0,api_root:"https://server.apxor.com/v2/api",auto_track_events:["click","submit"],cookie_expiration:730,name:"",domain:"",cookie_prefix:"_apx_",idle_time_out:1800,ed_t_time:-1,sct_time:108e5,events:{stop:[],action:[]}},g={debug:!1,honorDNT:!1,idle_time_out:1800,client_id:null,session_id:null,plugins:[],version:"ALL",events_upload_time:-1,retry_time:-1,bulk_upload:!0},h="Opera Mini",v="Opera",p="BlackBerry",m="Internet Explorer Mobile",b="Microsoft Edge",_="Facebook Mobile",S="Chrome",w="Chrome iOS",y="UC Browser",I="Firefox iOS",C="Mobile Safari",E="Safari",k="Android Mobile",T="Konqueror",x="Firefox",D="Internet Explorer",O="Mozilla",A="apx_id",q="_apx_config",U="_apx_ua",P="_apx_sc",N="_apx_ledt",M="_apx_lef",L="_apx_ch",R="_apx_lct",j="_apx_uih",B="apx_in",Q="apx_ver",z="apx_lbgt",J="visible",K="APX_PAGE_OPENED",F="apx_app_opened",W="SYSTEM_EVENT",H="NAVIGATION_EVENT",G="APP_EVENT",V="CLIENT_EVENT",X="apx_retained_session",Y="qe_state",Z="_apx_lEt",$="_apx_sId",ee="_apx_cd",te="_apx_od",ne="_apx_lt_count",ie="_apx_use",re="_apx_scnm",oe="apx_sst",se=o(function e(){i(this,e)});s(se,"isCookieAvailable",function(){try{var e=(new Date).getTime()+864e5;document.cookie="cookie_set=cookie_value; expires="+e;for(var t=document.cookie.split(";"),n=0;n<t.length;n++){if(-1!==t[n].indexOf("cookie_set"))return document.cookie="cookie_set=cookie_value; expires=Thu, 01 Jan 1970 00:00:01 GMT;",!0}return!1}catch(e){return!1}}),s(se,"get",function(e){if(window.document)for(var t=e+"=",n=window.document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return null});var ae,ue,le,ce,de=function(e){return void 0===e},fe=function(e){return null===e},ge=function(e){return void 0!==e&&!fe(e)},he=function(e){return!ge(e)},ve=function(e){return"function"==typeof e},pe=function(e){return"string"==typeof e},me=function(e){return"boolean"==typeof e},be=function(e){return ge(e)&&!fe(e)&&!isNaN(e)},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(null!=t&&ve(t)){var n=e.document;"loading"!==n.readyState?t():ve(n.addEventListener)?n.addEventListener("DOMContentLoaded",t):ve(e.attachEvent)&&e.attachEvent("onreadystatechange",function(e){"loading"!==n.readyState&&t(e)})}},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};ve(t)&&(e.addEventListener("pagehide",function(e){return t(e),""}),e.addEventListener("beforeunload",function(e){return t(e),""}),e.addEventListener("onunload",function(e){return t(e),""}))},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};ve(t)&&(e.removeEventListener("pagehide",t),e.removeEventListener("beforeunload",t),e.removeEventListener("onunload",t))},ye=function(e,t,n){ve(e.removeEventListener)?e.removeEventListener(t,n):ve(e.detachEvent)?e.detachEvent(t,n):e["on"+t]=n},Ie=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(e){return e<10?"0"+e:e},i=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds());return t?i+e.toTimeString().split(" ")[1].replace(/GMT([+|-])(\d{2})(\d{2})/,"$1$2:$3"):i},Ce=function(){return Date.now()},Ee=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},ke=function(){var e=window.navigator,t=(void 0===e?{}:e).userAgent,n=void 0===t?"":t;switch(!0){case/Windows Phone/i.test(n)||/WPDesktop/.test(n):return"Windows Phone";case/iPad/.test(n):return"iPad";case/iPod/.test(n):return"iPod Touch";case/iPhone/.test(n):return"iPhone";case/(BlackBerry|PlayBook|BB10)/i.test(n):return"BlackBerry";case/Android/.test(n):return"Android";default:return"Desktop"}},Te=function(){var e,n,i,r,o,a,u,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=l.navigator,d=void 0===c?{}:c,f=d.userAgent,g=void 0===f?"":f,A=d.vendor,q=void 0===A?"":A,U=h,P=v,N=p,M=m,L=b,R=_,j=S,B=w,Q=y,z=I,J=C,K=E,F=k,W=T,H=x,G=D,V=O,X=function(){switch(!0){case g.includes(" OPR/"):return g.includes("Mini")?U:P;case/(BlackBerry|PlayBook|BB10)/i.test(g):return N;case g.includes("IEMobile")||g.includes("WPDesktop"):return M;case g.includes("FBIOS"):return R;case g.includes("Chrome"):return j;case g.includes("CriOS"):return B;case g.includes("Edge"):return L;case g.includes("UCWEB")||g.includes("UCBrowser"):return Q;case g.includes("FxiOS"):return z;case q.includes("Apple"):return g.includes("Mobile")?J:K;case g.includes("Android"):return F;case g.includes("Konqueror"):return W;case g.includes("Firefox"):return H;case g.includes("MSIE")||g.includes("Trident/"):return G;case g.includes("Gecko"):return V;default:return""}}(),Y=function(){var e,t=(e={},s(e,M,/rv:(\d+(\.\d+)?)/),s(e,L,/Edge\/(\d+(\.\d+)?)/),s(e,j,/Chrome\/(\d+(\.\d+)?)/),s(e,B,/CriOS\/(\d+(\.\d+)?)/),s(e,Q,/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/),s(e,K,/Version\/(\d+(\.\d+)?)/),s(e,J,/Version\/(\d+(\.\d+)?)/),s(e,P,/(Opera|OPR)\/(\d+(\.\d+)?)/),s(e,H,/Firefox\/(\d+(\.\d+)?)/),s(e,z,/FxiOS\/(\d+(\.\d+)?)/),s(e,W,/Konqueror:(\d+(\.\d+)?)/),s(e,N,/BlackBerry (\d+(\.\d+)?)/),s(e,F,/android\s(\d+(\.\d+)?)/),s(e,G,/(rv:|MSIE )(\d+(\.\d+)?)/),s(e,V,/rv:(\d+(\.\d+)?)/),e)[X];if(void 0===t)return null;var n=g.match(t);return n?parseFloat(n[n.length-2]):null}(),Z=ke(),$=function(){switch(!0){case/Windows/i.test(g):return/Phone/.test(g)||/WPDesktop/.test(g)?"Windows Phone":"Windows";case/(iPhone|iPad|iPod)/.test(g):return"iOS";case/Android/.test(g):return"Android";case/(BlackBerry|PlayBook|BB10)/i.test(g):return"BlackBerry";case/Mac/i.test(g):return"Mac OS X";case/Linux/.test(g):return"Linux";case/CrOS/.test(g):return"Chrome OS";default:return""}}();return t(t({},(e=l.screen,i=(n=void 0===e?{width:0,height:0}:e).height,r=n.width,o=l.devicePixelRatio,a=void 0===o?1:o,{dimensions:{width:r,height:i},dimensions_in_pixels:{width:(u=function(e){var t=Math.round(e)*a,n=t%10;return t+(n>0?10:0)-n})(r),height:u(i)},dpi:a.toString()})),{},{device:Z,browser_version:Y,browser:X,os:$})},xe=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.navigator,r=(void 0===i?{}:i).language,o=n.browser_version,a=n.browser,u=se.isCookieAvailable();return s(e={},"apx_browser",a),s(e,"apx_browser_version",a+"_"+o),s(e,"apx_language",r),s(e,"apx_cookies_supported",u),e},De=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.navigator,n=void 0===t?{}:t,i=n.connection,r=void 0===i?{}:i,o=r.effectiveType,s=r.saveData,a=n.platform,u=n.webdriver,l=e.document.referrer,c={};o&&(c.apx_network=o),s&&(c.apx_data_save_mode=s),a&&(c.apx_platform=a),ge(u)&&u&&(c.apx_automation=u),ge(l)&&l.length>0?c.apx_referrer=l:c.apx_referrer="direct";var d=ke();return c.apx_device_type=d,c},Oe=function(e){var t=e.document.querySelector("title");return ge(t)&&ge(t.innerText)?t.innerText:"Unknown"},Ae=function(e){return be(e)?qe(e/1e3):e},qe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!be(e)||!be(t))return e;if(t%1!=0)return e;var n=Math.pow(10,t);return Math.round(e*n)/n},Ue=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).location,t=void 0===e?{}:e,n=t.protocol,i=t.host,r=t.hostName;return"file:"===n||"localhost"===i||"0.0.0.0"===r||"127.0.0.1"===r?"development":"production"},Pe=function(e){return e instanceof Object},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(Pe(e)){var i={};return Object.keys(t({},e)).forEach(function(t){var r=e[t],o=t;pe(t)||(o=JSON.stringify(t)),me(r)||be(r)?Re(i,o,r):pe(r)?i[o]=je(r):Array.isArray(r)?Me(i,o,r,n):Pe(r)&&Le(i,t,r,n-1)}),i}return{}},Me=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i<=0)Re(e,t,JSON.stringify(n));else if(Array.isArray(n)){var r=n;if(r.length>0){var o="";me(r[0])?o="b":pe(r[0])?o="s":be(r[0])?o="n":Array.isArray(r[0])?o="a":Pe(r[0])&&(o="o");var s=r.length;if(""===o)return void Re(e,t,JSON.stringify(n));for(var a=1;a<s;a++)if("s"===o){if(!pe(r[a]))return void Re(e,t,JSON.stringify(n))}else if("b"===o){if(!me(r[a]))return void Re(e,t,JSON.stringify(n))}else if("n"===o){if(!be(r[a]))return void Re(e,t,JSON.stringify(n))}else if("a"===o){if(!Array.isArray(r[a]))return void Re(e,t,JSON.stringify(n))}else if("o"===o&&!Pe(r[a]))return void Re(e,t,JSON.stringify(n));if("o"===o)if(i-1<=0){for(var u=[],l=0;l<s;l++)u.push(JSON.stringify(r[l]));Re(e,t,u)}else for(var c=0;c<s;c++)Le(e,t,r[c],i-1);else if("a"===o)for(var d=0;d<s;d++)Re(e,t,JSON.stringify(r[d]));else for(var f=0;f<s;f++)Re(e,t,r[f])}else Re(e,t,[])}},Le=function e(n,i,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o<=0?Re(n,i,JSON.stringify(r)):Object.keys(t({},r)).forEach(function(t){var s=i+"_"+t,a=r[t];ge(a)&&(Array.isArray(a)?Me(n,s,a,o-1):Pe(a)?e(n,s,a,o-1):Re(n,s,a))})},Re=function(e,t,n){if(ge(t)&&ge(n))if(e[t]){var i=e[t],r=i;Array.isArray(i)||((be(i)&&!be(n)||me(i)&&!me(n)||pe(i)&&!pe(n)||Pe(i)&&!Pe(n))&&(pe(i)||(i=JSON.stringify(i)),pe(n)||(n=JSON.stringify(n))),(r=[]).push(i)),r.push(n),e[t]=r}else e[t]=n},je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return pe(e)?e.length>t?e.slice(0,t)+"...":e:void 0},Be=function(e){if(!ge(e)&&!pe(e))return null;if("object"===n(e)||Pe(e))return e;var t=e.replace(/(?:\r\n|\r|\n)/g,"").trim();try{return JSON.parse(t)}catch(e){}return null},Qe=function(e,t){return ge(t)?function(e){var t,n,i,r,o,s,a,u,l,c=0,d="";if(!e)return e;do{t=e[c++],n=e[c++],i=e[c++],r=(u=t<<16|n<<8|i)>>18&63,o=u>>12&63,s=u>>6&63,a=63&u,d+=Je.charAt(r)+Je.charAt(o)+Je.charAt(s)+Je.charAt(a)}while(c<e.length);return((l=e.length%3)?d.slice(0,l-3):d)+"===".slice(l||3)}(t=function(e,t){return Array.from(t).map(function(t,n){return t.charCodeAt(0)^Ke(e,n)})}(e,t)):null},ze=function(e,t){return function(e,t){return Array.from(t).map(function(t,n){return String.fromCharCode(t^Ke(e,n))}).join("")}(e,t=function(e){var t,n,i,r,o,s,a,u,l=0,c=[];if(!e)return e;e+="";do{r=Je.indexOf(e.charAt(l++)),o=Je.indexOf(e.charAt(l++)),s=Je.indexOf(e.charAt(l++)),a=Je.indexOf(e.charAt(l++)),t=(u=r<<18|o<<12|s<<6|a)>>16&255,n=u>>8&255,i=255&u,c.push(t),64!==s&&(c.push(n),64!==a&&c.push(i))}while(l<e.length);return c}(t))},Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ke(e,t){return e.charCodeAt(Math.floor(t%e.length))}String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.from||(Array.from=(ae=Object.prototype.toString,ue=function(e){return"function"==typeof e||"[object Function]"===ae.call(e)},le=Math.pow(2,53)-1,ce=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),le)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!ue(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(n=arguments[2])}for(var r,o=ce(t.length),s=ue(this)?Object(new this(o)):new Array(o),a=0;a<o;)r=t[a],s[a]=i?void 0===n?i(r,a):i.call(n,r,a):r,a+=1;return s.length=o,s})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var r,o,s=0|t,a=Math.max(s>=0?s:i-Math.abs(s),0);for(;a<i;){if((r=n[a])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}});var Fe=["log","debug","info","warn","error"],We=Fe.reduce(function(e,t){return e[t]=t,e},{}),He=function(e){if(de(e)){var t=function(){return null};e=Fe.reduce(function(e,n){return e[n]=t,e},{})}return e},Ge=function(){function e(){i(this,e)}return o(e,null,[{key:"enabled",set:function(t){e._enabled=t}},{key:"level",set:function(t){e._level=t}},{key:"console",set:function(t){e._console=He(t)}}]),e}();function Ve(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Xe(e,t,n,i,r,o){return Ve((s=Ve(Ve(t,e),Ve(i,o)))<<(a=r)|s>>>32-a,n);var s,a}function Ye(e,t,n,i,r,o,s){return Xe(t&n|~t&i,e,t,r,o,s)}function Ze(e,t,n,i,r,o,s){return Xe(t&i|n&~i,e,t,r,o,s)}function $e(e,t,n,i,r,o,s){return Xe(t^n^i,e,t,r,o,s)}function et(e,t,n,i,r,o,s){return Xe(n^(t|~i),e,t,r,o,s)}function tt(e,t){var n,i,r,o,s;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var a=1732584193,u=-271733879,l=-1732584194,c=271733878;for(n=0;n<e.length;n+=16)i=a,r=u,o=l,s=c,a=Ye(a,u,l,c,e[n],7,-680876936),c=Ye(c,a,u,l,e[n+1],12,-389564586),l=Ye(l,c,a,u,e[n+2],17,606105819),u=Ye(u,l,c,a,e[n+3],22,-1044525330),a=Ye(a,u,l,c,e[n+4],7,-176418897),c=Ye(c,a,u,l,e[n+5],12,1200080426),l=Ye(l,c,a,u,e[n+6],17,-1473231341),u=Ye(u,l,c,a,e[n+7],22,-45705983),a=Ye(a,u,l,c,e[n+8],7,1770035416),c=Ye(c,a,u,l,e[n+9],12,-1958414417),l=Ye(l,c,a,u,e[n+10],17,-42063),u=Ye(u,l,c,a,e[n+11],22,-1990404162),a=Ye(a,u,l,c,e[n+12],7,1804603682),c=Ye(c,a,u,l,e[n+13],12,-40341101),l=Ye(l,c,a,u,e[n+14],17,-1502002290),a=Ze(a,u=Ye(u,l,c,a,e[n+15],22,1236535329),l,c,e[n+1],5,-165796510),c=Ze(c,a,u,l,e[n+6],9,-1069501632),l=Ze(l,c,a,u,e[n+11],14,643717713),u=Ze(u,l,c,a,e[n],20,-373897302),a=Ze(a,u,l,c,e[n+5],5,-701558691),c=Ze(c,a,u,l,e[n+10],9,38016083),l=Ze(l,c,a,u,e[n+15],14,-660478335),u=Ze(u,l,c,a,e[n+4],20,-405537848),a=Ze(a,u,l,c,e[n+9],5,568446438),c=Ze(c,a,u,l,e[n+14],9,-1019803690),l=Ze(l,c,a,u,e[n+3],14,-187363961),u=Ze(u,l,c,a,e[n+8],20,1163531501),a=Ze(a,u,l,c,e[n+13],5,-1444681467),c=Ze(c,a,u,l,e[n+2],9,-51403784),l=Ze(l,c,a,u,e[n+7],14,1735328473),a=$e(a,u=Ze(u,l,c,a,e[n+12],20,-1926607734),l,c,e[n+5],4,-378558),c=$e(c,a,u,l,e[n+8],11,-2022574463),l=$e(l,c,a,u,e[n+11],16,1839030562),u=$e(u,l,c,a,e[n+14],23,-35309556),a=$e(a,u,l,c,e[n+1],4,-1530992060),c=$e(c,a,u,l,e[n+4],11,1272893353),l=$e(l,c,a,u,e[n+7],16,-155497632),u=$e(u,l,c,a,e[n+10],23,-1094730640),a=$e(a,u,l,c,e[n+13],4,681279174),c=$e(c,a,u,l,e[n],11,-358537222),l=$e(l,c,a,u,e[n+3],16,-722521979),u=$e(u,l,c,a,e[n+6],23,76029189),a=$e(a,u,l,c,e[n+9],4,-640364487),c=$e(c,a,u,l,e[n+12],11,-421815835),l=$e(l,c,a,u,e[n+15],16,530742520),a=et(a,u=$e(u,l,c,a,e[n+2],23,-995338651),l,c,e[n],6,-198630844),c=et(c,a,u,l,e[n+7],10,1126891415),l=et(l,c,a,u,e[n+14],15,-1416354905),u=et(u,l,c,a,e[n+5],21,-57434055),a=et(a,u,l,c,e[n+12],6,1700485571),c=et(c,a,u,l,e[n+3],10,-1894986606),l=et(l,c,a,u,e[n+10],15,-1051523),u=et(u,l,c,a,e[n+1],21,-2054922799),a=et(a,u,l,c,e[n+8],6,1873313359),c=et(c,a,u,l,e[n+15],10,-30611744),l=et(l,c,a,u,e[n+6],15,-1560198380),u=et(u,l,c,a,e[n+13],21,1309151649),a=et(a,u,l,c,e[n+4],6,-145523070),c=et(c,a,u,l,e[n+11],10,-1120210379),l=et(l,c,a,u,e[n+2],15,718787259),u=et(u,l,c,a,e[n+9],21,-343485551),a=Ve(a,i),u=Ve(u,r),l=Ve(l,o),c=Ve(c,s);return[a,u,l,c]}function nt(e){var t,n="",i=32*e.length;for(t=0;t<i;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function it(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function rt(e){var t,n,i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return i}function ot(e){return unescape(encodeURIComponent(e))}function st(e){return function(e){return nt(tt(it(e),8*e.length))}(ot(e))}function at(e,t){return function(e,t){var n,i,r=it(e),o=[],s=[];for(o[15]=s[15]=void 0,r.length>16&&(r=tt(r,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^r[n],s[n]=1549556828^r[n];return i=tt(o.concat(it(t)),512+8*t.length),nt(tt(s.concat(i),640))}(ot(e),ot(t))}s(Ge,"_console",He()),s(Ge,"_enabled",!1),s(Ge,"_level","error"),s(Ge,"_render",function(e){return function(){var t=Fe.indexOf(e)>=Fe.indexOf(Ge._level);if(Ge._enabled&&t){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];Ge._console[e].apply(Ge._console,i)}}}),s(Ge,"log",Ge._render(We.log)),s(Ge,"info",Ge._render(We.info)),s(Ge,"debug",Ge._render(We.debug)),s(Ge,"warn",Ge._render(We.warn)),s(Ge,"error",Ge._render(We.error));var ut=function(e,t,n){return t?n?at(t,e):rt(at(t,e)):n?st(e):rt(st(e))},lt=o(function e(){var t=this;i(this,e),s(this,"NIpa",function(e,n){if(t._listeners[e])for(var i=t._listeners[e],r=0;r<i.length;r++){(0,i[r])(n)}}),s(this,"registerForEvent",function(e,n){var i;ve(n)&&((i=t._listeners[e]?t._listeners[e]:[]).push(n),t._listeners[e]=i)}),s(this,"unregisterFromEvent",function(e,n){if(t._listeners[e]){for(var i=t._listeners[e],r=[],o=0;o<i.length;o++){var s=i[o];s!==n&&r.push(s)}t._listeners[e]=r}}),s(this,"wjlf",function(){t._listeners={}}),this._listeners={}}),ct=function(e,t){return{name:e===J?"FOREGROUND":"BACKGROUND",time:be(t)?qe(t):0}},dt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(pe(e)&&Pe(t))return{name:e,additional_info:t,category:ge(n)&&pe(n)?n:void 0,time:be(i)?qe(i):0}},ft=function(e,t,n,i,r){return{app_name:e,app_version:r=ge(r)?r:"ALL",bundle_id:t,installation_time:n,app_mode:i}},gt=function(e,t,n,i,r,o,s,a){return{id:e,hardware_model:t,dimensions:n,os_version:i,platform:"web",dpi:r,dimensions_in_pixels:o,browser:s,browser_version:a}},ht=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{navigation_id:e,name:t,duration:be(n)?qe(n):0,transition_time:be(i)?qe(i):0}},vt={navigation_events:[],app_events:[],system_events:[],user_events:[],chunk_attributes:{},user_attributes:{},session_attributes:{}},pt=function(e){return{sdk_version:190,config_id:"apx",tick_interval:1,chunk_retry_window:1800,sdk_start_time:e}},mt=function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Ge.debug("Model : Building the initial state of the Chunk"),{sdk_info:pt(e),session_info:{id:i,launch_time:n,launch_time_string:Ie(new Date(n)),startup_time:0,is_background:!1,is_first_session:!1,duration:0,total_duration:0,process_name:"",is_fatal:!1,launch_type:"normal"},app_info:{app_name:"",app_version:"ALL",bundle_id:"",installation_time:Ot.getInstance().getInstallationTime(Ce()),app_mode:"production"},device_info:Te(window),chunk_meta:{id:i+":"+r,number:r,reporting_times:[]},chunk_details:t(t({},vt),{},{user_attributes:{},session_attributes:{}})}},bt=o(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),s(this,"qBsv",function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=t.window.XMLHttpRequest;Ge.debug("Request : POST request with data"),s?t.WuxB(e,n,i,r,o):(Ge.error("Request : Unknown browser"),i(403,"Unknown")),Ge.debug("Request : Sent request to server")}),s(this,"get",function(e,n){var i=t.window,r=i.fetch,o=i.XMLHttpRequest;if(r)r(e).then(function(e){try{if(e.ok)return e.json()}catch(e){Ge.debug("Request : Error while parsing the response ".concat(e))}return null}).then(function(e){ge(e)?n(200,e):(Ge.error("Request : API request failed. ".concat(JSON.stringify(e))),n(500,{}))}).catch(function(e){Ge.error("Request : API request failed. ".concat(e)),n(500,e)});else if(o){var s=new o;s.open("GET",e,!0),s.onreadystatechange=function(){4===s.readyState&&n(s.status,s.responseText)},s.send()}else Ge.error("Request : Unknown browser"),n(403,"Unknown");Ge.debug("Request : sent request to server")}),s(this,"WuxB",function(e,n,i,r,o){var s=new XMLHttpRequest;s.onerror=function(e){Ge.error("Request : API request failed. ".concat(e)),i(500,null)},s.open("POST",e,o),s.setRequestHeader("Content-Type","application/json; charset=UTF-8"),Object.keys(null!=r?r:{}).forEach(function(e){s.setRequestHeader(e,r[e])}),s.onreadystatechange=function(){if(4===s.readyState){var r=s.responseText,o=r.match(/Failed to execute 'send' on 'XMLHttpRequest'/);if(!(fe(o)||de(o)||fe(o[0])||de(o[0])||"Failed to execute 'send' on 'XMLHttpRequest'"!==o[0]))return void t.WuxB(e,n,i,!0);try{r=JSON.parse(r)}catch(e){Ge.debug("Request : Error while parsing the response ".concat(e))}i(s.status,r)}};try{s.send(JSON.stringify(n))}catch(e){Ge.error("Request : API request failed. ".concat(e)),i(500,e)}}),this.window=n}),_t=f.api_root,St=function(e,t){return _t+e.replace("<app-id>",t)},wt=o(function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),s(this,"suDx",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};return function(n,i){Ge.debug("XHR Response: [".concat(n,"]")),n<400?i&&"APXOR_STATUS_SUCCESS"===i.apxor_status?i.details?e(i.details):e(i):200===n?e(i):t(n,i):t&&ve(t)&&t(n,i)}}),s(this,"OCLq",function(e,t){n.makeGetRequest(n.sdkEnabledStatusAPI,e,t)}),s(this,"DZgQ",function(e,t){n.makeGetRequest(n.configAPI,e,t)}),s(this,"cYXr",function(e,t,i){n.request.qBsv(n.userInfoAPI,e,n.suDx(t,i),{})}),s(this,"LrnG",function(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Ge.debug("Posting chunk"),n.request.qBsv(n.chunksAPI,e,n.suDx(t,i),{},r)}),s(this,"makeGetRequest",function(e,t,i){n.request.get(e,n.suDx(t,i))}),s(this,"makePostRequest",function(e,t,i,r,o){n.request.qBsv(e,t,n.suDx(r,o),i)}),this.request=new bt(r),this.configAPI=St("/config/<app-id>/web",t),this.chunksAPI=St("/<app-id>/chunks",t),this.sdkEnabledStatusAPI=St("/sdk/<app-id>/enabled-status?platform=web&version=190",t),this.userInfoAPI=St("/user?appId=<app-id>",t)}),yt=o(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i(this,e),s(this,"oyhU",-1),s(this,"ZEMj",0),s(this,"KjWc",function(){return t.ZEMj}),s(this,"VUmg",function(){return t.oyhU}),s(this,"ulll",function(){t.oyhU=-1,t.ZEMj=0}),s(this,"accs",function(e){if("FOREGROUND"===e.name){if(-1!==t.oyhU){var n=Math.round(Ae(Date.now()-t.oyhU));t.ZEMj+=n;var i=Ot.getInstance().getFromStorage($);if(ge(i)&&Ot.getInstance().getSessionId()!==i){Ot.getInstance().ZzTF();var r=Ot.getInstance().XUlD(),o=r.total_duration,s=r.duration;t.ZEMj=o>s?o-s:0}}}else t.oyhU=Date.now(),Ot.getInstance().persistToStorage(z,t.oyhU)}),Ot.getInstance().registerForEvent(W,this._onSystemEvent),this.ZEMj=n,Ot.getInstance().persistToStorage(z,this.oyhU)}),It=function(){function e(t){var n=this;i(this,e),s(this,"JSXK",!1),s(this,"fkYy",function(e){var t=!0;try{window[e]?(window[e].setItem("_apx_","apx"),"apx"!==window[e].getItem("_apx_")&&(t=!1),window[e].removeItem("_apx_")):t=!1}catch(e){t=!1}return t||Ge.error("Storage : LocalStorage not supported"),t}),s(this,"ltCA",function(e){Ge.error("".concat(n.storageType," Error: "),e)}),s(this,"get",function(e){try{return n.storage.getItem(e)}catch(t){Ge.error("Storage : Error while getting the ".concat(e," from storage - ").concat(t))}return null}),s(this,"dFhe",function(e){try{return JSON.parse(n.storage.getItem(e))}catch(t){Ge.error("Storage : Error while parsing ".concat(e,"'s value from storage - ").concat(t))}return null}),s(this,"set",function(e,t){try{n.storage.setItem(e,t)}catch(t){Ge.error("Storage : Error while setting the ".concat(e,"'s value to storage - ").concat(t))}}),s(this,"SRjo",function(e){try{n.storage.removeItem(e)}catch(t){Ge.error("Storage : Error while removing the ".concat(e," from storage - ").concat(t))}}),s(this,"clear",function(){try{n.storage.removeItem(q),n.storage.removeItem(U),n.storage.removeItem(Z),n.storage.removeItem($),n.storage.removeItem(P),n.storage.removeItem(A),n.storage.removeItem(B),n.storage.removeItem(Q),n.storage.removeItem(z),n.storage.removeItem(ee),n.storage.removeItem(te),n.storage.removeItem(ne),n.storage.removeItem(ie),n.storage.removeItem(re),n.storage.removeItem(R),n.storage.removeItem(L),n.storage.removeItem(M),n.storage.removeItem(N)}catch(e){Ge.error("Storage : Error while clearing the storage - ".concat(e))}}),this.JSXK=this.fkYy(t),this.JSXK?(this.storage=window[t],this.storageType=t):(this.storageType=t,this.storage={length:0,getItem:function(){},setItem:function(){},removeItem:function(){},clear:function(){},get:function(){},set:function(){},remove:function(){},getParsed:function(){}})}return o(e,[{key:"isStorageAvailable",value:function(){return this.JSXK}}],[{key:"waitForBrowserStorage",value:function(t){var n=15,i=setInterval(function(){n--,e.isLocalStorageEnabled()||n<=0?(Ge.debug("Storage : Local storage available"),clearInterval(i),t()):Ge.debug("Storage : Local storage not available yet")},100)}},{key:"isLocalStorageEnabled",value:function(){try{var e="__apx_storage_test__";window.localStorage.setItem(e,"test");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test"===t}catch(e){return Ge.debug("Browser storage is not enabled yet : ".concat(e)),!1}}}]),e}();var Ct=function(){function e(n){var r=this;i(this,e),s(this,"fOge",""),s(this,"qXiT",function(){var e,t=r.storage.get(q);if(ge(t))try{t=JSON.parse(ze(r.fOge,t))}catch(e){t=null}return null!==(e=t)&&void 0!==e?e:f}),s(this,"CMON",function(e){r.storage.set(q,Qe(r.fOge,JSON.stringify(e)))}),s(this,"tvaS",function(e){r.storage.set(A,e)}),s(this,"BhuG",function(){var e=null;try{e=r.storage.get(A)}catch(e){Ge.debug("Datamaager : Can not get user id from storage-"+e)}return e}),s(this,"IUKu",function(e){return r.storage.set(Q,e)}),s(this,"uETt",function(){var e=r.storage.get(Q);if(!ge(e)&&se.isCookieAvailable()){var t=se.get(Q);if(ge(t))return r.storage.set(Q,t),t}return e}),s(this,"cTcd",function(e,t){r.storage.set(e,t)}),s(this,"getItem",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r.storage.get(e);if(t){var i=Be(n);if(null===i)try{n=JSON.parse(ze(r.fOge,n))}catch(t){Ge.debug("Datamanager : ".concat(e," - value not found in storage")),n=null}else n=i}return Ge.debug("Datamanager : ".concat(e,"'s value from storage is ").concat(JSON.stringify(n))),n}),s(this,"zIkR",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r.getItem(e,n);return ge(i)?i:(Ge.debug("Datamanager : ".concat(e,"'s value is not defined. Returning default-").concat(JSON.stringify(t))),t)}),s(this,"PQMh",function(){r.storage.clear()}),s(this,"zIQe",function(e){Ge.debug("DataManager : Setting the installation time to ".concat(e)),r.storage.set(B,e)}),s(this,"getInstallationTime",function(e){var t=r.storage.get(B);return ge(t)?(Ge.debug("Datamanager : Stored installation time ".concat(t)),Number(t)):(Ge.debug("Datamanager : Stored installation time not found. Persisting and returning the default time ".concat(e)),r.zIQe(e),e)}),s(this,"uEeg",function(e){Ge.debug("Datamanager : Persisting the old session chunk to the storage"),r.storage.set(te,Qe(r.fOge,JSON.stringify(e)))}),s(this,"DTAV",function(){var e;Ge.debug("Datamanager : Getting the old session chunk details form the storage");var t=r.storage.get(te),n=Be(t);if(null===n)try{t=JSON.parse(ze(r.fOge,t))}catch(e){t=null}else t=n;return null!==(e=t)&&void 0!==e?e:[]}),s(this,"QGyz",function(){Ge.debug("Datamanager : Removing the old session chunk details form the storage"),r.storage.SRjo(te)}),s(this,"VCpd",function(){return r.getItem(ie,!0)}),s(this,"vOUO",function(e){Ge.debug("Datamanager : Persisting the old session chunk details to the storage"),r.storage.set(ie,Qe(r.fOge,JSON.stringify(e)))}),s(this,"XgkJ",function(){Ge.debug("Datamanager : Removing the old session chunk details form the storage"),r.storage.SRjo(ie)}),s(this,"KsMs",function(){Ge.debug("Datamanager : Getting the session chunknumber map");var e=r.getItem(re,!0);return ge(e)||(e={}),e}),s(this,"NmOY",function(e){Ge.debug("Datamanager : Persisting the new session chunknumber map");var t=Qe(r.fOge,JSON.stringify(e));r.cTcd(re,t)}),s(this,"xiKr",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3600;Ge.debug("Datamanager : Creating a new chunk");var s,a=!1,u=Number(r.storage.get(Z))||0,l=Date.now(),c=Math.round(Ae(l-u)),d=r.fSpB();if((c>o||he(d))&&(a=!0),a)Ge.debug("Datamanager : This is a new session. Creating a new chunk"),s=mt(e,n,i);else{Ge.debug("Datamanager : This is an old session. Updating the existing chunk");var f=d.chunk_meta.number,g=d.session_info.id,h=f+1;(s=t({},d)).chunk_meta=t(t({},s.chunk_meta),{},{number:h,id:g+":"+h,reporting_times:[Date.now()]}),s.chunk_details=t({},vt)}return{is_new_session:a,chunk:s}}),s(this,"MEcG",function(){Ge.debug("Datamanager : Current chunk removed from storage"),r.storage.SRjo(ee)}),s(this,"fcUn",function(e){Ge.debug("Datamanager : Persisting the Current chunk to storage"),r.storage.set(ee,Qe(r.fOge,JSON.stringify(e)))}),s(this,"fSpB",function(){return r.getItem(ee,!0)}),this.fOge=n,this.storage=new It("localStorage"),Ge.debug("DataManager : Initialized")}return o(e,[{key:"getltCount",value:function(e){try{var t=this.storage.get(ne);if(t){var n=ze(this.fOge,t);return JSON.parse(n)[e.replace("'","").replace("’","")]}}catch(t){Ge.error("Datamanager : Error gettting the LT Count for the event -"+e)}return 0}},{key:"updateRetainedDayCount",value:function(e){Ge.debug("Datamanager : Re-calculating and updating the retention day");var t=this.getItem(B),n=Math.abs(t-e)/36e5,i=Math.floor(n/24);this.cTcd("apx_retained_days",i)}}]),e}(),Et=["scroll","touchmove"],kt=o(function e(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];i(this,e),s(this,"iBEC",!0),s(this,"mRav",function(){Ge.debug("Registering for System Event ","visibilitychange");var e=function(){var e=Ot.getInstance(),n=e.getSDKRunningTimeInSec(),i=window.document.visibilityState===J,r=ct(window.document.visibilityState,n);if(i?(e.dfvU(!1),t.oyhU>-1&&(e.fPxQ(function(){e.dispatchEvent(W,r)}),r.background_time=qe(Ae(Date.now()-t.oyhU)))):(e.dfvU(!0),e.kiGS(),t.oyhU=Date.now(),e.dispatchEvent(W,r)),i){var o=e.getUserAttributes().apx_browser;!t.iBEC||-1!==o.indexOf("Mobile Safari")&&-1!==o.indexOf("Safari")||(t.iBEC=!1)}else e.sLYc()};!function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ve(e.addEventListener)?e.addEventListener(t,n,i):ve(e.attachEvent)?e.attachEvent(t,n):e["on"+t]=n}(document,"visibilitychange",e),t._handlers.push(t.gsqi("visibilitychange",e))}),s(this,"ehfS",function(){t._handlers.forEach(function(e){var t=e.type,n=e.handler;Ge.debug("Unregistering from event type ",t),Et.includes(t)?ye(window.document,t,n):ye(document,t,n)}),t._handlers=[],t._scrollEvents=[],t._scrollData={}}),s(this,"EOuZ",function(){return[]}),s(this,"gsqi",function(e,t){return{type:e,handler:t}}),this.oyhU=-1,this._handlers=[],this._scrollEvents=[],this._scrollData={},this.iBEC=n,this.mRav()}),Tt=o(function e(){var t=this;i(this,e),s(this,"aLtd",!0),s(this,"fOge",""),s(this,"initialize",function(e,n){t.fOge=n;var i=e.validate_hash,r=void 0===i||i,o=e.cs_ht_time,s=void 0===o?-1:o;t.aLtd=r,t.configsHashThrottleTime=s,Ot.getInstance().registerForEvent(G,function(e){t.rBpi(e.name)})}),s(this,"fetchConfiguration",function(e,n,i,r){if(ve(r))if(t.aLtd){var o=Ot.getInstance();if(t.configsHashThrottleTime>0){var s=o.RTiR(e+"_lcfht",-1);if(s>0)if(Math.abs(Date.now()-s)<t.configsHashThrottleTime)return void t.TNpH(e,r)}o.persistToStorage(e+"_lcfht",Date.now());var a=t.LDbP(),u={pid_mid:[]},l=a[e];if(ge(l)){Array.isArray(l)||(l=[l]);var c=[];l.forEach(function(e){var t=e.pid+"_"+e.mid;c.includes(t)||c.push(t)}),c.length>0&&(u.pid_mid=c.join(","))}else l=[];var d=o.getUserAttributes().custom_user_id,f=void 0===d?null:d;f&&(n+="&customerId="+f),o.makePostRequest(n,u,{"Content-Type":"application/json"},function(n){t.bkyB(n,e,i,{configs:l,syncData:a},r)},function(){Ge.error("Failed to fetch"),r(e,{configs:l})})}else t.kXaw(e,i,[],r)}),s(this,"LDbP",function(){var e=Ot.getInstance().getFromStorage(P,!0);return ge(e)?e:{}}),s(this,"TNpH",function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=i;i||(r=t.LDbP());var o=r[e];ge(o)&&(Array.isArray(o)||(o=[o]),Ge.debug("Reading from storage"),n(e,{configs:o}))}),s(this,"bkyB",function(e,n,i,r,o){var s=e.pull,a=void 0===s?[]:s,u=e.drop,l=void 0===u?[]:u,c=r.configs,d=r.syncData,f=[];l.length>0||a.length>0?(c.forEach(function(e){l.includes(e.pid)||a.includes(e.pid)||f.push(e)}),d[n]=f,Ot.getInstance().persistToStorage(P,Qe(t.fOge,JSON.stringify(d)))):(Ge.debug("Nothing to delete",n),f=c),a.length>0?(a.forEach(function(e){i+="&pids="+e}),t.kXaw(n,i,f,o)):(Ge.debug("Nothing to pull",n),o(n,{configs:f}))}),s(this,"kXaw",function(e,n,i,r){Ot.getInstance().makeGetRequest(n,function(n){if(ge(n.configs)&&Array.isArray(n.configs)&&0==n.configs.length)r("",{configs:[]});else if(ge(n.configs)&&Array.isArray(n.configs)){var o=t.LDbP(),s=[].concat(u(i),u(n.configs));o[e]=s,Ot.getInstance().persistToStorage(P,Qe(t.fOge,JSON.stringify(o))),r(e,{configs:s})}},function(){r(e,{configs:[]})})}),s(this,"SCIO",function(e){t.rBpi(e)}),s(this,"rBpi",function(e){var n=t.LDbP();if(ge(n.d)||(n.d={}),JSON.stringify(n.d).length>2097152)Ge.error("Sync : Reached maximum limit. Can't store further");else{var i=0;ge(n.d[e])&&(i=n.d[e]),i+=1,n.d[e]=i,Ot.getInstance().persistToStorage(P,Qe(t.fOge,JSON.stringify(n)))}}),s(this,"getEventCount",function(e){var n=t.LDbP();return ge(n.d)&&ge(n.d[e])?n.d[e]:0})}),xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){Ge.error("".concat(e,": Apxor SDK not initialised."))}},Dt={reportChunkOnVisibilityChange:xt("kiGS"),logAppEvent:xt("Pguw"),logClientEvent:xt("logClientEvent"),logPageView:xt("logPageView"),setUserId:xt("setUserId"),setUserProperties:xt("setUserProperties"),setSessionProperties:xt("setSessionProperties"),setAppVersion:xt("setAppVersion"),getClientId:xt("getClientId"),getSessionId:xt("getSessionId"),startSession:xt("startSession"),endSession:xt("endSession"),flattenJSON:xt("flattenJSON"),setRedirectionHandler:xt("setRedirectionHandler"),setInitFlag:xt("setInitFlag")},Ot=function(){function e(){var n=this;return i(this,e),s(this,"PQAR",{}),s(this,"IqBU",!1),s(this,"ZDrj",{}),s(this,"kgqL",{}),s(this,"Mviu",{}),s(this,"Ixjm",{}),s(this,"mvzJ",{}),s(this,"uLmC",{}),s(this,"qEIt",{}),s(this,"YTzz",1),s(this,"yxjl",null),s(this,"iSfS",!1),s(this,"HxfU",!1),s(this,"bapQ",{}),s(this,"tXgt",{}),s(this,"FTvZ",{}),s(this,"HlTJ",{}),s(this,"fLWd",3600),s(this,"skAG",20),s(this,"aMGF",-1),s(this,"OdBW",2e4),s(this,"WSfU",-1),s(this,"WhdG",10),s(this,"TnTt",!1),s(this,"nfZP",!1),s(this,"Qhgo",-1),s(this,"GHcm",!1),s(this,"KkEQ",!0),s(this,"clientEvents",[]),s(this,"arDs",[]),s(this,"fHCo",[]),s(this,"MXfv",[]),s(this,"rTlM",{}),s(this,"mehg",-1),s(this,"MVLC",null),s(this,"qklA",null),s(this,"HaUR",null),s(this,"zjcD",!1),s(this,"jmfk",!1),s(this,"aPMN",{}),s(this,"initWaitTime",1500),s(this,"version",""),s(this,"LTUp",""),s(this,"ATvi",""),s(this,"sessionStartTime",null),s(this,"sessionId",""),s(this,"ohzf",{}),s(this,"yCxy",function(e){var t=n.config.plugins;if(ge(t)&&ge(t.length))for(var i=0;i<t.length;i++){var r=t[i];try{var o;null===(o=window[r])||void 0===o||o.init(e),Ge.debug("Controller : Initialized plugin ".concat(r))}catch(e){Ge.error("Controller : Failed to initialize plugin ".concat(r," with error ").concat(e))}}}),s(this,"initialize",function(e,t,i,r,o,s){if(!n.IqBU){var a=function(){Ge.debug("Controller : On Site enabled in config"),n.rZpR(u,s)},u=function(e){n.ATvi=e,Ge.debug("Controller : On config hash fetch"),n.ahOX(e,l)},l=function(){Ge.info("Controller : Waiting for resources completed"),n.VqcW(),n.XqLz(),n.QujL(),n.LTUp=n.OYMz(),n.roVi(),n.Znoy(),n.sFiK(),n.Eiaf(),n.oaum(),n.GXDY(),n.iHfM(),n.iDdo(n.ATvi);var e=n.zQnn();n.FTvZ=new yt(e),n.sNLD(),n.fPxQ(c)},c=function(){n.iSfS=!0,n.IqBU=!0;var e=n.ZzTF();n.bapQ.fcUn(e),n.yCxy(d)},d=function(){n.Uhjh(n.window.document.visibilityState),n.newSession&&(n.sessionStartTime=Date.now(),n.Pguw(F,{time:Ie(new Date)}),n.bdNS()),n.logPageView(n.window.location.pathname),n.EWgl(),n.tvKT(),o()};n.dhyS(function(){Ge.debug("Controller : Wait for browser storage completed."),n.ZWvb(e,t,i,r),n.Tchy(),n.VijE(),n.HlTJ.initialize(n.config,n.siteId),n.BwjC(a,s)})}}),s(this,"getSiteId",function(){return n.siteId}),s(this,"setRedirectionHandler",function(e){n.IqBU?n.MVLC?n.MVLC=e:(n.MVLC=e,n.registerForEvent("CLIENT_EVENT",n.wMYQ)):Dt.setRedirectionHandler()}),s(this,"wMYQ",function(e){e&&"REDIRECT"===e.name&&n.MVLC(e.additional_info.url)}),s(this,"makePostRequest",function(e,t,i,r,o){n._api.makePostRequest(e,t,i,r,o)}),s(this,"getDevInfo",function(){return n.kgqL}),s(this,"gEvO",function(){return n.aPMN}),s(this,"KEHM",function(e,i){n.aPMN[e]=n.aPMN[e]||{},n.aPMN[e]=t(t({},n.aPMN[e]),i)}),s(this,"getInstallationTime",function(){return n.bapQ.getInstallationTime(n.startTime)}),s(this,"dhyS",function(e){Ge.debug("Controller : Checking if the browsers localstorage is available."),It.waitForBrowserStorage(e)}),s(this,"ZWvb",function(e,t,i,r){Ge.debug("Controller : Initializing the state variables"),n.window=r,n.startTime=t,n.siteId=e,n.clientConfig=i||{},n.initWaitTime=n.clientConfig.sdk_init_wait?1e3*n.clientConfig.sdk_init_wait:2e3,n._api=new wt(n.siteId,n.window),n.bapQ=new Ct(n.siteId),n.PQAR=new lt,n.HlTJ=new Tt,n.Mviu=pt(n.startTime),n.sessionStartTime=n.bapQ.zIkR(oe,t),Ge.debug("Controller : session start time is ".concat(n.sessionStartTime)),Ge.debug("Controller : SDK start time is ".concat(n.startTime)),n.sessionId=n.getFromStorage($)}),s(this,"XqLz",function(){Ge.debug("Controller : Initializing the LT Count ");try{var e=n.getFromStorage(ne);if(e)n.ohzf=JSON.parse(ze(n.siteId,e));else{n.ohzf={};var t=Qe(n.siteId,JSON.stringify(n.ohzf));n.persistToStorage(ne,t)}}catch(e){Ge.error("Controller : LT Count object parsing failed ".concat(e))}}),s(this,"VqcW",function(){var e=new URLSearchParams(location.search),t=e.get("_a")||e.get("_p")||e.get("_x")||e.get("_o")||e.get("_r");if(t)try{Ge.debug("Controller : Initialising in WYSIWYG mode");var i=ze(n.siteId,t),r=i=JSON.parse(i),o=r.app_id,s=r.expiry,a=Date.now();if(o===n.siteId&&a<=s){var u=new Date(s+6e4).toUTCString(),l=btoa("_apx_ew");document.cookie="_apx_ewc=".concat(l,"; expires=").concat(u),i.expiry=i.expiry+6e4,n.persistToStorage("_apx_ew",i,!0),Ge.debug("Controller : _apx_ewc cookie set")}e.delete("_a"),e.delete("_p"),e.delete("_x"),e.delete("_o"),e.delete("_r");var c=location.pathname,d=e.toString();""!==d&&(c+="?"+d),n.window.history.replaceState({},document.title,c),Ge.debug("Controller : Query params reset after removing dashboard embedded params")}catch(e){Ge.error("Controller : Error while setting the WYSIWYG cookie ".concat(e))}else Ge.debug("Controller : Not in WYSIWYG mode")}),s(this,"Tchy",function(){Ge.debug("Controller : Setting the config");var e=n.bapQ.qXiT();n.bWYH(e)}),s(this,"bWYH",function(e){n.config=t(t({},e),n.clientConfig),Ge.debug("Controller : New config and client configs Configs merged")}),s(this,"VijE",function(){var e,t,i,r=n.config,o=r.version,s=void 0===o?"":o,a=r.bulk_upload,u=void 0===a||a,l=r.events_upload_time,c=r.idle_time_out,d=void 0===c?1800:c,f=r.events,g=void 0===f?{}:f,h=r.max_chunk_event_count,v=void 0===h?20:h,p=r.retry_time,m=r.max_sessions_in_storage,b=void 0===m?-1:m;n.version=n.eaVM(s),n.KkEQ=u,n.GHcm=l>0,n.fLWd=be(d)?d:1800,n.arDs=null!==(e=g.stop)&&void 0!==e?e:[],n.fHCo=null!==(t=g.action)&&void 0!==t?t:[],n.MXfv=null!==(i=g.app)&&void 0!==i?i:[],n.skAG=ge(v)&&be(v)?v:20,n.aMGF=ge(l)&&be(l)&&l>=1e3?l:-1,n.WSfU=ge(p)&&be(p)&&p>=1e3?p:-1,n.WhdG=be(b)&&b>0?b:-1}),s(this,"eaVM",function(e){var t;if(ge(e))t=""+e,n.bapQ.IUKu(t);else{var i=n.bapQ.uETt();t=ge(i)?i:"ALL"}return t}),s(this,"BwjC",function(e,t){if(Ge.debug("Controller : Checking if the Site is enabled existing config"),!n.config.enable)return Ge.debug("Controller : Site is disabled. Can't initialise"),n.iDdo(""),n.sFiK(),void t();e()}),s(this,"rZpR",function(e,t){var i=n.bapQ.qXiT(),r=n.bapQ.zIkR(N,-1),o=i.ed_t_time;if(o>0&&r>0&&Math.abs(r-Date.now())<60*o*1e3)return Ge.debug("Controller : Reinitializing with in the throttling time."),n.bapQ.zIkR(M,!0)?void e(n.bapQ.zIkR(L,"")):(Ge.debug("Controller : Site is not enabled from the last update. Can't initalise now. Recheck will happen after throttling time"),void t());n.UpJO(e,t)}),s(this,"UpJO",function(e,t){Ge.debug("Controller : Getting the site enabled status from the server"),n.persistToStorage(N,Date.now()),n._api.OCLq(function(i){var r=i.enabled,o=i.hash;n.persistToStorage(M,r),r?(Ge.debug("Controller : Site is enabled"),e(o)):(Ge.debug("Controller : Site is disabled. Can't initialise the SDK"),n.IqBU=!1,n.iSfS=!1,n.vVKt(),t())},function(e){Ge.error("Controller : enabled-status API failed ".concat(e))})}),s(this,"vVKt",function(){Ge.debug("Controller: Stopping the SDK");try{var e,t;n.iSfS=!1,n.IqBU=!1,n.TnTt=!1,null===(e=n.PQAR)||void 0===e||e.wjlf(),null===(t=n.tXgt)||void 0===t||t.ehfS()}catch(e){Ge.error("Controller : Failed to stop the SDK ".concat(e))}}),s(this,"ahOX",function(e,t){Ge.debug("Controller: Waiting ".concat(n.initWaitTime,"ms for all the resource loading to finish")),setTimeout(function(){t(e)},n.initWaitTime)}),s(this,"OYMz",function(){var e=n.bapQ.BhuG();if(!ge(e)){Ge.debug("Controller : Device id not found in localstorage");var t=n.config.client_id;ge(t)&&""!==t?(Ge.debug("Controller : client id from clientconfig is the deviceid"),e=t):(Ge.debug("Controller : Generated a new device id. This is a new device now"),e=Ee()),n.PRjR(e)}return Ge.debug("Controller : Device id is ".concat(e)),n.LTUp=e,e}),s(this,"PRjR",function(e){n.bapQ.PQMh(),n.bapQ.tvaS(e),n.bapQ.zIQe(Date.now()),n.Ixjm=t(t({},n.Ixjm),{},{is_first_session:!0}),n.nfZP=!0}),s(this,"GXDY",function(){Ge.debug("Controller : Setting the session state for session if ".concat(n.sessionId)),n.sessionId||(n.newSession=!0,n.sessionId=Ee(),n.persistToStorage($,n.sessionId),n.persistToStorage(oe,n.sessionStartTime))}),s(this,"roVi",function(){var e=Te(n.window),t=e.device,i=e.os,r=e.browser_version,o=e.browser,s=e.dimensions,a=e.dpi,u=e.dimensions_in_pixels;n.kgqL=gt(n.LTUp,t,s,i,a,u,o,r)}),s(this,"Znoy",function(){Ge.debug("Controller : Setting the default User attributes");var e=t({},n.kgqL),i=xe(n.window,e);n.mvzJ=t(t({},n.mvzJ),i)}),s(this,"oaum",function(){Ge.debug("Controller : Setting the default session attributes");var e=De(n.window);n.uLmC=t(t({},n.uLmC),e)}),s(this,"Eiaf",function(){Ge.debug("Controller : Merging the stored and default user attributes");var e=n.getFromStorage(U,!0);if(ge(e)){var i,r=Be(e);if(null===r)try{r=JSON.parse(ze(n.siteId,e))}catch(e){r={}}n.mvzJ=t(t({},n.mvzJ),null!==(i=r)&&void 0!==i?i:{})}}),s(this,"iHfM",function(){n.qEIt=t(t({},vt),{},{user_attributes:t({},n.mvzJ),session_attributes:t({},n.uLmC)}),n.bapQ.vOUO(n.qEIt)}),s(this,"fPxQ",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Ge.debug("Controller : Sending the old chunk to the server");var i=n.bapQ.DTAV();if(ge(i)){var r,o,s,a,u,l,c,d,f,g,h=t({},n.qEIt);if(n.qEIt=t({},i.chunk_details)||{},(null===(r=n.qEIt)||void 0===r?void 0:null===(o=r.app_events)||void 0===o?void 0:o.length)>0||n.xfMx(),!((null===(s=n.qEIt)||void 0===s?void 0:null===(a=s.app_events)||void 0===a?void 0:a.length)>0))return n.qEIt=t({},h),void e();var v=null!==(u=null===(l=i=t(t({},i),{},{chunk_details:t({},n.qEIt)}))||void 0===l?void 0:null===(c=l.session_info)||void 0===c?void 0:c.id)&&void 0!==u?u:"1",p=null!==(d=null===(f=i)||void 0===f?void 0:null===(g=f.chunk_meta)||void 0===g?void 0:g.number)&&void 0!==d?d:1;n.bapQ.fcUn(i),n._api.LrnG(i,function(){n.biIW(v,p+1),Ge.debug("Controller : Old chunk reporting successful."),n.bapQ.QGyz(),n.bapQ.XgkJ(),n.iHfM(),n.SMfx(),e()},function(){Ge.debug("Controller : Old chunk reporting failed."),e()})}else e()}),s(this,"xfMx",function(){var e=n.bapQ.VCpd();if(ge(e)){var t=e.app_events,i=e.navigation_events,r=e.system_events,o=e.user_events;n.qEIt.app_events=[].concat(u(n.qEIt.app_events||[]),u(t)),n.qEIt.navigation_events=[].concat(u(n.qEIt.navigation_events||[]),u(i)),n.qEIt.system_events=[].concat(u(n.qEIt.system_events||[]),u(r)),n.qEIt.user_events=[].concat(u(n.qEIt.user_events||[]),u(o)),n.bapQ.XgkJ()}}),s(this,"biIW",function(e,t){var i=n.bapQ.KsMs();i[e]=t,n.bapQ.NmOY(i),n.YTzz=t}),s(this,"SMfx",function(){var e=n.ZzTF();return n.bapQ.fcUn(e),e}),s(this,"ZzTF",function(){var e=ge(n.config.name)?n.config.name:"",i=ge(n.config.domain)?n.config.domain:"",r=n.bapQ.xiKr(n.startTime,n.sessionStartTime,n.sessionId,n.fLWd),o=r.chunk,s=o.session_info,a=o.app_info,u=o.sdk_info,l=o.chunk_details,c=o.chunk_meta,d=l.session_attributes,f=l.user_attributes;return n.Ixjm=s,n.Ixjm.is_first_session=n.nfZP,n.Mviu=u,n.ZDrj=t(t({},a),{},{app_name:e,bundle_id:i,app_version:n.version}),n.YTzz=c.number,n.mvzJ=t(t({},n.mvzJ),f),n.uLmC=t(t({},n.uLmC),d),n.qEIt=l,n.xfMx(),n.newSession=r.is_new_session,n.newSession||n.LUeo(o),{sdk_info:n.Mviu,session_info:n.Ixjm,app_info:n.ZDrj,device_info:n.kgqL,chunk_details:l,chunk_meta:c}}),s(this,"LUeo",function(e){var t=e.session_info.id;t&&(n.sessionId=t,n.persistToStorage($,n.sessionId))}),s(this,"zQnn",function(){var e=n.Ixjm,t=e.total_duration,i=e.duration;return t>i?t-i:0}),s(this,"iDdo",function(e){if(Ge.debug("Controller : Fetch a new config"),n.kKBo(e)){var t=n.config.sct_time,i=n.bapQ.zIkR(R,-1);if(t>0&&i>0)if(Math.abs(Date.now()-i)<t)return void Ge.debug("Controller : No need to fetch config. Did not pass the throttle time");n.persistToStorage(R,Date.now()),n._api.DZgQ(function(e){var t;Ge.debug("Controller : New config fetched"),n.bapQ.CMON(e),n.persistToStorage(L,null!==(t=e.hash)&&void 0!==t?t:ut(e)),n.bWYH(e),n.QujL()},function(e){0!==e&&Ge.error("Controller : Failed to fetch config")})}else Ge.debug("Controller : No need to fetch config. No change in hash")}),s(this,"sFiK",function(){Ge.debug("Controller : Posting user info");var e=n.Mviu.sdk_version,t={sdk_version:JSON.stringify(e),app_info:n.ZDrj,device_info:n.kgqL,user_attributes:n.mvzJ},i=ut(t),r=n.bapQ.zIkR(j,"");i!==r?n._api.cYXr(t,function(){Ge.debug("Controller : Posted user info. Persisting the hash to localstorage"),n.persistToStorage(j,i)}):Ge.debug("Controller : No need to post user info. No change in it")}),s(this,"kKBo",function(e){return""===e||n.bapQ.zIkR(L,"")!==e}),s(this,"Uhjh",function(e){Ge.debug("Controller : Dispatching SYSTEM_EVENT");var t=ct(e,n.pmqK());n.dispatchEvent(W,t)}),s(this,"bdNS",function(){Ge.debug("Controller : Resetting the session frequncy of all the campaigns to 0");var e={};try{var t=n.getFromStorage(Y);ge(t)&&(e=JSON.parse(ze(n.siteId,t))),Object.entries(e).forEach(function(t){var n=a(t,1)[0];return e[n].SESSION=0})}catch(t){e={},Ge.error("Controller : Can't reset campaign limits:".concat(t))}n.persistToStorage(Y,e,!0),n.window.ApxorRTM.resetFrequencyCounts()}),s(this,"sNLD",function(){Ge.debug("Registering a handler for the system events"),_e(n.window,function(){n.HxfU||(n.fhAV(),n.tXgt=new kt(!1),n.HxfU=!0)})}),s(this,"fhAV",function(){var e=!1;Se(window,function(){(Ge.debug("Controller : Executing before unload"),e)||n.iSfS&&(e=!0,window.document.visibilityState===J&&(n.btIQ(!0),n.Uhjh("hidden")),clearInterval(n.qklA),clearInterval(n.HaUR),n.KkEQ&&n.bapQ.vOUO(n.qEIt),n.tXgt.ehfS())})}),s(this,"tvKT",function(){Ge.debug("Controller : Registering the handlers for chunk reporting"),clearInterval(n.HaUR),n.HaUR=setInterval(function(){n.EWgl()},n.OdBW),n.GHcm&&(clearInterval(n.qklA),n.qklA=setInterval(function(){n.zxkb()},n.aMGF))}),s(this,"EWgl",function(){var e=n.qEIt,t=e.app_events,i=e.navigation_events;t.length+i.length>0&&!n.zjcD&&n.HMdK()}),s(this,"zxkb",function(){var e=n.qEIt,t=e.app_events,i=e.navigation_events,r=t.length+i.length;(!n.KkEQ&&r>0||n.KkEQ&&r>=n.skAG)&&n.HMdK()}),s(this,"HMdK",function(){Ge.debug("Controller : Preparing and reporting chunk");var e=n.DWYh(n.qEIt);n.uufT(e,!1)}),s(this,"DWYh",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ge.debug("Controller : Preparing chunk"),n.Mtps();var i={id:n.sessionId+":"+n.YTzz,number:n.YTzz,reporting_times:[Date.now()]};return e=t(t({},e),{},{user_attributes:n.mvzJ,session_attributes:n.uLmC}),{sdk_info:n.Mviu,session_info:n.Ixjm,app_info:n.ZDrj,device_info:n.kgqL,chunk_meta:i,chunk_details:e}}),s(this,"Mtps",function(){Ge.debug("Controller : Updating the foreground time");var e=n.getSDKRunningTimeInSec(),i=e;e-=n.FTvZ.KjWc(),n.Ixjm=t(t({},n.Ixjm),{},{duration:qe(e),total_duration:qe(i)})}),s(this,"uufT",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(Ge.debug("Controller : Reporting chunk"),n.TnTt||n.WSfU>0&&-1!==n.Qhgo&&Date.now()-n.Qhgo<n.WSfU)n.iHfM();else{var r=e.chunk_details,o=r.app_events,s=r.system_events,a=r.navigation_events,u=r.user_events;if(o.length<1&&s.length<1&&a.length<1&&u.length<1)return Ge.debug("Controller : Chunk not sent. No events in the chunk"),n.TnTt=!1,void i();n.TnTt=!0,n.biIW(n.Ixjm.id,n.YTzz+1),n.bapQ.XgkJ(),n.bapQ.QGyz(),n.iHfM(),t?(n.TnTt=!1,n.bapQ.uEeg(e),i()):(n.bapQ.fcUn(e),n._api.LrnG(e,function(){Ge.debug("Controller : Chunk successfully sent"),n.TnTt=!1,n.Qhgo=-1,i()},function(t){Ge.debug("Controller : Chunk sending failed"),0!==t&&(n.TnTt=!1,t>=500&&(n.Qhgo=Date.now()),413!==t&&417!==t&&n.bapQ.uEeg(e),i())}))}}),s(this,"setUserId",function(e){n.IqBU?n.iSfS?de(e)||(Ge.debug("Controller : User id set"),n.setUserProperties({custom_user_id:e})):Ge.warn("Apxor SDK is not running"):Dt.setUserId()}),s(this,"setUserProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.IqBU)if(n.iSfS){if(Object.keys(e).length>0){n.mvzJ=t(t({},n.mvzJ),e);try{Ge.debug("Controller : User properties set"),n.persistToStorage(U,Qe(n.siteId,JSON.stringify(n.mvzJ)))}catch(e){Ge.debug("Controller : Error while setting the use properties ".concat(e))}}}else Ge.warn("Apxor SDK is not running");else Dt.setUserProperties()}),s(this,"setSessionProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.IqBU?n.iSfS?Object.keys(e).length>0&&(Ge.debug("Controller : Session properties set"),n.uLmC=t(t({},n.uLmC),e)):Ge.warn("Apxor SDK is not running"):Dt.setSessionProperties()}),s(this,"setAppVersion",function(e){n.IqBU?n.iSfS?n.version=e:Ge.warn("Apxor SDK is not running"):Dt.setAppVersion()}),s(this,"QujL",function(){Ge.debug("Controller : Updating the App info");var e=n.config,t=e.name,i=void 0===t?"":t,r=e.domain,o=void 0===r?n.window.location.host:r,s=n.bapQ.getInstallationTime(n.startTime),a=Ue(n.window),u=ge(n.clientConfig.version)?""+n.clientConfig.version:n.bapQ.uETt(),l=i;""===i&&"Unknown"===(l=Oe(n.window))&&(l=""),n.ZDrj=ft(l,o,s,a,u)}),s(this,"getEventCount",function(e){var t=-1;return n.clientEvents.forEach(function(n){n.name===e&&(t+=1)}),-1===t?n.HlTJ.getEventCount(e):t}),s(this,"sLYc",function(){n.btIQ(),n.yxjl=null}),s(this,"btIQ",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ge.debug("Controller : Ending the navigation"),ge(n.yxjl)&&(n.yxjl.duration=qe(n.getSDKRunningTimeInSec()-n.yxjl.transition_time),n.dispatchEvent(H,t({},n.yxjl),e))}),s(this,"getSessionId",function(){return n.sessionId}),s(this,"jIMb",function(){return n.IqBU?n.iSfS?n.LTUp:(Ge.warn("Controller : Apxor SDK is not running"),null):(Dt.getClientId(),null)}),s(this,"kiGS",function(){var e;if(n.IqBU){var t=n.DWYh(n.qEIt),i=n.siteId,r=JSON.stringify(t);(null===(e=n.qEIt)||void 0===e?void 0:e.app_events.length)>0&&(Ge.debug("Reporting a chunk on visibility change with sendBeacon"),n.bapQ.XgkJ(),n.bapQ.uEeg(t),navigator.sendBeacon("https://server.apxor.com/v2/api/".concat(i,"/text-chunks?appId=").concat(i),r))}}),s(this,"CWMA",function(e){if(he(n.ohzf[e])&&0!==n.ohzf[e])n.ohzf[e]=0;else{var t=n.ohzf[e];t+=1,n.ohzf[e]=t}var i=Qe(n.siteId,JSON.stringify(n.ohzf));n.persistToStorage(ne,i)}),s(this,"Pguw",function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!n.IqBU||!n.iSfS)return Ge.warn("Controller : Can't log App event. SDK not initialised"),void Dt.Pguw();try{if(pe(e)&&Pe(i)){var s=e.replace("'","").replace("’","");n.CWMA(s);var a=n.ohzf[s]||0;i=t(t({},i),{},{apx_lt_count:a});var u=dt(e,Ne(i),r,n.pmqK()),l=G;if(n.arDs.includes(e))return;n.fHCo.includes(e)&&(l=V),Ge.debug("Controller : Logging event ".concat(e)),n.KEHM(e,i),n.dispatchEvent(l,u,!1,o)}else Ge.debug("Controller : Invalid App Event ".concat(e))}catch(e){Ge.error("LT Count object parsing failed ".concat(e))}}),s(this,"logClientEvent",function(e,i){if(!n.IqBU||!n.iSfS)return Ge.warn("Controller : Can't log client event. SDK not initialised"),void Dt.logClientEvent();var r=n.bapQ.getltCount(e);i=t(t({},i),{},{apx_lt_count:r});var o=dt(e,Ne(i),null,n.pmqK()),s=V;n.arDs.includes(e)||(n.MXfv.includes(e)&&(s=G),o?(Ge.debug("Controller : Logging client event ".concat(e)),n.KEHM(e,i),n.dispatchEvent(s,o)):Ge.debug("Controller : Invalid client event ".concat(e)))}),s(this,"logPageView",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.pmqK();if(!n.IqBU||!n.iSfS)return Ge.warn("Controller : Can't log page event. SDK not initialised"),void Dt.logPageView();if("string"==typeof e&&e&&e.length>0){var i=qe(t),r=ht(e,Oe(n.window),0,i);n.HlTJ.SCIO(e),ge(n.yxjl)?(n.btIQ(),n.yxjl=r):n.yxjl=r,n.Pguw(K,{time:Ie(new Date),navigation_id:e}),Ge.debug("logPageView: page view is logged ",e)}else Ge.warn("Controller : Can't log page event as pathname is empty")}),s(this,"dispatchEvent",function(e,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Ge.debug("Controller : Dispatching Event ".concat(i.name)),n.bapQ.updateRetainedDayCount(Date.now());var s=!1,a=function(){var a=n.qEIt.app_events;switch(s&&(i.time=n.pmqK()),e){case G:n.qEIt=t(t({},n.qEIt),{},{app_events:[].concat(a,i)});break;case V:n.clientEvents.push(i)}if(n.PQAR.NIpa(e,i),!s&&e!==V){n.qEIt=t(t({},n.qEIt),{},{user_attributes:t({},n.mvzJ),session_attributes:t({},n.uLmC)});var u=n.DWYh(n.qEIt,e);if(n.bapQ.vOUO(n.qEIt),n.bapQ.uEeg(u),!0!==o)if(n.KkEQ){if(a.length+1<n.skAG)return;n.uufT(u,r)}else r||e!==G||n.GHcm||n.uufT(u,r);else n.uufT(u,r)}},u=function(){n.persistToStorage(Z,Date.now()),a()};if(e===G){var l=Date.now(),c=n.getFromStorage(Z);c=Number(c),be(c)&&c>0&&Math.round(Ae(l-c))>n.fLWd?n.endSession(!0,function(){s=!0,n.startNewSession(Date.now(),u)}):(n.persistToStorage(Z,Date.now()),a())}else a()}),s(this,"startNewSession",function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.IqBU||r?n.iSfS?i():(n.sessionId=Ee(),Ge.debug("Controller : New session started with id ".concat(n.sessionId)),n.persistToStorage($,n.sessionId),n.mehg=null!==(e=n.getFromStorage(X))&&void 0!==e?e:0,n.mehg=Number(n.mehg)+1,n.persistToStorage(X,n.mehg),n.sessionStartTime=t,n.persistToStorage(oe,n.sessionStartTime),n.FTvZ.ulll(),n.SMfx(),n.tXgt=new kt(n.config),n.iSfS=!0,n.bdNS(),i()):Dt.startSession()}),s(this,"endSession",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(n.IqBU)if(n.iSfS){e||n.btIQ();var r=t(t({},n.qEIt),{},{user_attributes:t({},n.mvzJ),session_attributes:t({},n.uLmC)}),o=n.DWYh(r);n.bapQ.XgkJ();var s=function(){n.bapQ.MEcG(),n.FTvZ.ulll(),ge(n.tXgt)&&n.HxfU&&n.tXgt.ehfS(),we(document),n.iSfS=!1,i(),Ge.debug("Controller : Current session ended")};n.WSfU>0&&n.Qhgo>0?(n.bapQ.uEeg(o),s()):n.uufT(o,!1,s)}else Ge.warn("Apxor SDK is not running. Please make sure to call 'startSession'");else Dt.endSession()}),s(this,"persistToStorage",function(e,t){var i=t;arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&Pe(i)&&(i=Qe(n.siteId,JSON.stringify(i))),n.bapQ.cTcd(e,i)}),s(this,"getFromStorage",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.bapQ.getItem(e,t)}),s(this,"RTiR",function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.bapQ.zIkR(e,t,i)}),s(this,"XUlD",function(){return n.Ixjm}),s(this,"getUserAttributes",function(){return n.mvzJ}),s(this,"getSessionAttributes",function(){return n.uLmC}),s(this,"makeGetRequest",function(e,t,i){n._api.makeGetRequest(e,t,i)}),s(this,"fetchConfiguration",function(e,t,i,r){n.HlTJ.fetchConfiguration(e,t,i,r)}),s(this,"flattenJSON",function(e){return Ne(e,2)}),s(this,"registerForEvent",function(e,t){n.PQAR.registerForEvent(e,t)}),s(this,"unregisterFromEvent",function(e,t){n.PQAR.unregisterFromEvent(e,t)}),s(this,"getSDKRunningTimeInSec",function(){return Ae(Date.now()-n.startTime)}),s(this,"pmqK",function(){var e=Date.now();return Ge.debug("Controller : Time elapsed in session is ".concat((e-n.sessionStartTime)/1e3,"sec")),Ae(e-n.sessionStartTime)}),s(this,"dfvU",function(e){n.zjcD=e}),e.instance||(e.instance=this),e.instance}return o(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();s(Ot,"instance",void 0);var At=o(function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce();i(this,e),s(this,"IqBU",!1),s(this,"LNuD",[]),s(this,"version",190),s(this,"oYRc",function(){Array.isArray(n._q)&&n._q.forEach(function(e){var t=e.m,i=e.args;n[t]&&ve(n[t])&&n[t].apply(n,Array.from(i))})}),s(this,"init",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{if(Ge.debug("SDK : Apxor SDK initialization has started"),!n.IqBU){var o,s,a,u;ge(t)&&(!ge(t)||t instanceof Object)||(t=g);var l=t,c=l.honorDNT,d=void 0!==c&&c,f=l.debug,h=void 0!==f&&f,v=l.events_upload_time,p=void 0===v?-1:v,m=l.retry_time,b=void 0===m?-1:m,_=l.level,S=void 0===_?"error":_;if(null!==(o=n.window)&&void 0!==o&&null!==(s=o.localStorage)&&void 0!==s&&s.getItem("apx_debug_enable")&&(h="true"===n.window.localStorage.getItem("apx_debug_enable")),null!==(a=n.window)&&void 0!==a&&null!==(u=a.localStorage)&&void 0!==u&&u.getItem("apx_log_level")&&(S=n.window.localStorage.getItem("apx_log_level")),n.DALo(h,S),!ge(e)||!ge(e.trim)||""===e.trim())return Ge.error("SDK : ApxorSDK couldn't be initialized: Invalid Site Id:".concat(e)),n._controller=Dt,void(null!=r&&ve(r)&&r());if(d&&!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.navigator){var t=e.navigator.doNotTrack;return!("1"===t||"yes"===t)}return!0}(n.window))return n._controller=Dt,null!=r&&ve(r)&&r(),void Ge.error("SDK : Tracking is disabled, ApxorSDK couldn't be initialized");n._controller=Ot.getInstance(),ge(p)&&p>0&&(t.events_upload_time*=1e3),ge(b)&&b>0&&(t.retry_time*=1e3),n._controller.initialize(e,n._startTime,t,n.window,function(){n.LNuD.forEach(function(e){var t=e.m,i=e.args;n._controller[t].apply(n._controller,Array.from(i))}),n.IqBU=!0,null!=i&&ve(i)&&(Ge.debug("SDK : Device id is "+n.getClientId()),i({client_id:n.getClientId(),session_id:n.getSessionId()})),n.window.console.info("ApxorSDK initialized for site:"+e+" with SDK version: 190")},function(){n.IqBU=!1,Ge.error("SDK : Failed to initialize Apxor SDK"),r&&ve(r)&&r("")})}}catch(e){n._controller.IqBU=!1,Ge.error("SDK : Exception while initializing Apxor SDK : ",e),r&&ve(r)&&r(e)}}),s(this,"DALo",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";Ge.enabled=e,Ge.level=t,Ge.console=n.window.console,Ge.debug("SDK : Logger configured with level ".concat(t))}),s(this,"logEvent",function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.IqBU?n._controller.Pguw(e,t,void 0,i):n.LNuD.push({m:"Pguw",args:[e,t]})}),s(this,"logClientEvent",function(e,t){n.IqBU?n._controller.logClientEvent(e,t):n.LNuD.push({m:"logClientEvent",args:[e,t]})}),s(this,"logPageView",function(e){n.IqBU?n._controller.logPageView(e):n.LNuD.push({m:"logPageView",args:[e]})}),s(this,"setUserId",function(e){n.IqBU?n._controller.setUserId(e):n.LNuD.push({m:"setUserId",args:[e]})}),s(this,"setUserProperties",function(e){Ge.debug("SDK : User properties set"),n.IqBU?n._controller.setUserProperties(e):n.LNuD.push({m:"setUserProperties",args:[e]})}),s(this,"setSessionProperties",function(e){Ge.debug("SDK : Session properties set"),n.IqBU?n._controller.setSessionProperties(e):n.LNuD.push({m:"setSessionProperties",args:[e]})}),s(this,"setAppVersion",function(e){n.IqBU?n._controller.setAppVersion(e):n.LNuD.push({m:"setAppVersion",args:[e]})}),s(this,"flattenJSON",function(e){n.IqBU?n._controller.flattenJSON(e):n.LNuD.push({m:"flattenJSON",args:[e]})}),s(this,"getSessionId",function(){return n.IqBU?n._controller.getSessionId():null}),s(this,"getClientId",function(){return n._controller.jIMb()}),s(this,"startNewSession",function(){Ge.debug("SDK : A new session started"),n.IqBU?n._controller.startNewSession(Date.now()):n.LNuD.push({m:"startNewSession",args:[]})}),s(this,"endSession",function(){Ge.debug("SDK : Current session ended"),n.IqBU?n._controller.endSession():n.LNuD.push({m:"endSession",args:[]})}),s(this,"getController",function(){return n._controller}),s(this,"getSiteId",function(){var e;return null===(e=n._controller)||void 0===e?void 0:e.getSiteId()}),s(this,"setRedirectionHandler",function(e){ve(e)?n.IqBU?n._controller.setRedirectionHandler(e):n.LNuD.push({m:"setRedirectionHandler",args:[e]}):Ge.error("Callback must be a function")}),s(this,"setInitFlag",function(e){n.IqBU=e}),this.window=t,this._startTime=r,this.oYRc()});window.Apxor=window.Apxor||{_q:[],_st:Date.now()},At.prototype._q=window.Apxor._q;var qt=new At(window,+window.Apxor._st);window.Apxor=qt,window.ApxorLogger=Ge;try{void 0===exports&&null===exports||(exports.default=qt,module.exports=exports.default)}catch(e){}return qt});
